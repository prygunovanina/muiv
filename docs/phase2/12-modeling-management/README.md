# Управление моделированием

Для отображения различных состояний документа в процессе его жизненного цикла разработана UML-диаграмма состояний.

## Начальное состояние

Точка входа в диаграмму, из которой осуществляется переход в первое рабочее состояние.

## Состояние "Черновик"

### Характеристика
Документ создан, но еще не зарегистрирован официально.

### Разрешенные действия
- Редактирование реквизитов и содержимого документа
- Добавление и удаление файлов
- Изменение связей с другими документами

### Действия при входе
- Создание карточки документа
- Назначение временного идентификатора

### Переходы
- По событию "Регистрация" переход в "Зарегистрирован" при условии заполнения всех обязательных реквизитов
- По событию "Удаление" переход в "Удален"

## Состояние "Зарегистрирован"

### Характеристика
Документу присвоен официальный регистрационный номер.

### Действия при входе
- Генерация регистрационного номера
- Фиксация даты регистрации
- Публикация события о регистрации документа

### Ограничения
Возможен ограниченный набор изменений документа.

### Переходы
- По событию "Отправка на согласование" переход в "На согласовании"
- По событию "Отправка на рассмотрение" переход в "На рассмотрении"
- По событию "Отправка в архив" переход в "В архиве" при истечении срока хранения

## Состояние "На рассмотрении"

### Характеристика
Документ находится у ответственного лица для ознакомления и принятия решения.

### Действия при входе
- Создание задачи для исполнителя
- Отправка уведомления

### Переходы
- По событию "Рассмотрен" переход в "Зарегистрирован" или "На согласовании" в зависимости от решения
- По событию "Возврат автору" переход в "Черновик" с возможностью доработки

## Составное состояние "На согласовании"

### Характеристика
Включает внутренние подсостояния, отражающие этапы маршрута согласования.

### Подсостояние "Первичное согласование"

#### Характеристика
Документ проходит согласование у первого этапа согласующих лиц.

#### Действия при входе
- Создание задач для всех участников этапа
- Отправка уведомлений

#### Переходы
- При получении всех положительных решений переход в подсостояние "Финальное согласование"
- При получении отрицательного решения переход в состояние "Отклонен"

### Подсостояние "Финальное согласование"

#### Характеристика
Утверждение документа руководителем.

#### Действия при входе
- Создание задачи для руководителя
- Отправка уведомления

#### Переходы
- При положительном решении переход в состояние "Утвержден"
- При отрицательном решении переход в состояние "Отклонен"

## Состояние "Утвержден"

### Характеристика
Документ прошел все этапы согласования и получил официальное утверждение.

### Действия при входе
- Фиксация даты утверждения
- Наложение электронной подписи утвердившего лица
- Публикация события об утверждении
- Отправка уведомления автору

### Переходы
- По событию "Отправка в архив" переход в "В архиве" после истечения срока действия или по запросу

## Состояние "Отклонен"

### Характеристика
Документ не прошел согласование.

### Действия при входе
- Фиксация причины отклонения
- Отправка уведомления автору с комментариями

### Переходы
- По событию "Доработка" переход в "Черновик" для внесения изменений и повторной отправки на согласование

## Состояние "В архиве"

### Характеристика
Документ перемещен в архив для долгосрочного хранения.

### Действия при входе
- Изменение прав доступа на режим "только чтение"
- Перенос файлов в архивное хранилище
- Формирование описи

### Переходы
- По событию "Восстановление из архива" переход в "Зарегистрирован" при необходимости повторного использования
- По событию "Уничтожение" переход в "Удален" после истечения срока хранения

## Конечное состояние "Удален"

### Характеристика
Документ удален из системы.

### Действия при входе
- Пометка записи как удаленной
- Перемещение файлов в карантин на случай восстановления
- Публикация события об удалении

## Охранные условия на переходах

### Условие перехода из "Черновик" в "Зарегистрирован"
[все обязательные поля заполнены AND прикреплен хотя бы один файл]

### Условие перехода из "На согласовании" в "Утвержден"
[получены положительные решения от всех участников маршрута]

### Условие перехода из "Зарегистрирован" в "В архиве"
[текущая дата > дата регистрации + срок хранения в активном доступе]

## Назначение диаграммы

Диаграмма состояний обеспечивает контроль корректности переходов между статусами документа и определяет разрешенные действия в каждом состоянии, что гарантирует целостность данных и соблюдение бизнес-правил.
